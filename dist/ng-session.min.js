!function(n){"use strict";function e(n,e,r){function s(e,r){n.session.user=r.data,e.resolve(r)}function t(n){return c(null,n)}function o(e,r){n.session.user=null,e.resolve(r)}function l(s,i){var o=r.defer();return n.session.user=null,e.post(u.signInUrl,s,i).then(t.bind(null,o)).catch(o.reject),o.promise}function g(n,s){var t=r.defer();return e.post(u.signOutUrl,n,s).then(o.bind(null,t)).catch(t.reject),t.promise}function c(n,t){return t||(t=r.defer()),e.get(u.updateUrl,n||{}).then(s.bind(null,t)).catch(t.reject),t.promise}function a(e){var r=n.session;return r?e&&r.user?r.user[e]:r.user:null}function f(n,e){var r=a("roles"),s=0;if(!r||!r.length)return!1;i.isString(r)&&(r=[r]),i.isString(n)&&(n=[n]);for(var t=0,u=n.length;t<u;t++)r.indexOf(n[t])>-1&&s++;return e?s===n.length:!!s}function d(e,r){n.session[e]=r}function p(e){return n.session[e]}function U(e){delete n.session[e]}n.session={};var h={hasRole:f,signOut:g,signIn:l,update:c,user:a,get:p,set:d,del:U};return h}function r(n){n.update()}function s(n){i.isString(n.updateUrl)&&(u.updateUrl=n.updateUrl),i.isString(n.signInUrl)&&(u.signInUrl=n.signInUrl),i.isString(n.signOutUrl)&&(u.signOutUrl=n.signOutUrl)}function t(){return o}var i=n.angular,u={signOutUrl:"/api/users/sign-out",signInUrl:"/api/users/sign-in",updateUrl:"/api/session"},o={configure:s,$get:["$rootScope","$http","$q",e]};i.module("ngSession",[]).provider("ngSession",t).run(["ngSession",r])}(window);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXNlc3Npb24uanMiXSwibmFtZXMiOlsid2luZG93IiwibmdTZXNzaW9uU2VydmljZUZuIiwiJHJvb3RTY29wZSIsIiRodHRwIiwiJHEiLCJvblNlc3Npb25VcGRhdGVTdWNjZXNzIiwiZGVmZXJyZWQiLCJyZXMiLCJzZXNzaW9uIiwidXNlciIsImRhdGEiLCJyZXNvbHZlIiwib25TaW5nSW5TdWNjZXNzIiwidXBkYXRlIiwib25TaW5nT3V0U3VjY2VzcyIsInNpZ25JbiIsIm9wdGlvbnMiLCJkZWZlciIsInBvc3QiLCJjb25maWciLCJzaWduSW5VcmwiLCJ0aGVuIiwiYmluZCIsImNhdGNoIiwicmVqZWN0IiwicHJvbWlzZSIsInNpZ25PdXQiLCJzaWduT3V0VXJsIiwiZ2V0IiwidXBkYXRlVXJsIiwicHJvcCIsImhhc1JvbGUiLCJyb2xlcyIsImFsbCIsImFjdHVhbCIsIm1hdGNoZXMiLCJsZW5ndGgiLCJuZyIsImlzU3RyaW5nIiwiaSIsImwiLCJpbmRleE9mIiwic2V0IiwidmFsdWUiLCJkZWwiLCJuZ1Nlc3Npb25TZXJ2aWNlRGVmIiwibmdTZXNzaW9uUnVuRm4iLCIkc2Vzc2lvbiIsImNvbmZpZ3VyZSIsImNmZyIsIm5nU2Vzc2lvblByb3ZpZGVyRm4iLCJuZ1Nlc3Npb25Qcm92aWRlckRlZiIsImFuZ3VsYXIiLCIkZ2V0IiwibW9kdWxlIiwicHJvdmlkZXIiLCJydW4iXSwibWFwcGluZ3MiOiJDQVNDLFNBQVVBLEdBQ1QsWUFnQkEsU0FBU0MsR0FBbUJDLEVBQVlDLEVBQU9DLEdBYTdDLFFBQVNDLEdBQXVCQyxFQUFVQyxHQUN4Q0wsRUFBV00sUUFBUUMsS0FBT0YsRUFBSUcsS0FFOUJKLEVBQVNLLFFBQVFKLEdBUW5CLFFBQVNLLEdBQWdCTixHQUN2QixNQUFPTyxHQUFPLEtBQU1QLEdBUXRCLFFBQVNRLEdBQWlCUixFQUFVQyxHQUNsQ0wsRUFBV00sUUFBUUMsS0FBTyxLQUUxQkgsRUFBU0ssUUFBUUosR0FtQm5CLFFBQVNRLEdBQU9MLEVBQU1NLEdBQ3BCLEdBQUlWLEdBQVdGLEVBQUdhLE9BU2xCLE9BTkFmLEdBQVdNLFFBQVFDLEtBQU8sS0FFMUJOLEVBQU1lLEtBQUtDLEVBQU9DLFVBQVdWLEVBQU1NLEdBQ2hDSyxLQUFLVCxFQUFnQlUsS0FBSyxLQUFNaEIsSUFDaENpQixNQUFNakIsRUFBU2tCLFFBRVhsQixFQUFTbUIsUUFtQmxCLFFBQVNDLEdBQVFoQixFQUFNTSxHQUNyQixHQUFJVixHQUFXRixFQUFHYSxPQU1sQixPQUpBZCxHQUFNZSxLQUFLQyxFQUFPUSxXQUFZakIsRUFBTU0sR0FDakNLLEtBQUtQLEVBQWlCUSxLQUFLLEtBQU1oQixJQUNqQ2lCLE1BQU1qQixFQUFTa0IsUUFFWGxCLEVBQVNtQixRQW1CbEIsUUFBU1osR0FBT0csRUFBU1YsR0FVdkIsTUFUS0EsS0FDSEEsRUFBV0YsRUFBR2EsU0FJaEJkLEVBQU15QixJQUFJVCxFQUFPVSxVQUFXYixPQUN6QkssS0FBS2hCLEVBQXVCaUIsS0FBSyxLQUFNaEIsSUFDdkNpQixNQUFNakIsRUFBU2tCLFFBRVhsQixFQUFTbUIsUUFhbEIsUUFBU2hCLEdBQUtxQixHQUNaLEdBQUl0QixHQUFVTixFQUFXTSxPQUV6QixPQUFLQSxHQUlEc0IsR0FBUXRCLEVBQVFDLEtBQ1hELEVBQVFDLEtBQUtxQixHQUdmdEIsRUFBUUMsS0FQTixLQXlCWCxRQUFTc0IsR0FBUUMsRUFBT0MsR0FDdEIsR0FBSUMsR0FBU3pCLEVBQUssU0FDZDBCLEVBQVUsQ0FFZCxLQUFLRCxJQUFXQSxFQUFPRSxPQUNyQixPQUFPLENBR0xDLEdBQUdDLFNBQVNKLEtBQ2RBLEdBQVVBLElBR1JHLEVBQUdDLFNBQVNOLEtBQ2RBLEdBQVNBLEdBR1gsS0FBSyxHQUFJTyxHQUFJLEVBQUdDLEVBQUlSLEVBQU1JLE9BQVFHLEVBQUlDLEVBQUdELElBQ25DTCxFQUFPTyxRQUFRVCxFQUFNTyxLQUFNLEdBQzdCSixHQUlKLE9BQUlGLEdBQ0tFLElBQVlILEVBQU1JLFNBR2xCRCxFQVdYLFFBQVNPLEdBQUlaLEVBQU1hLEdBQ2pCekMsRUFBV00sUUFBUXNCLEdBQVFhLEVBWTdCLFFBQVNmLEdBQUlFLEdBQ1gsTUFBTzVCLEdBQVdNLFFBQVFzQixHQVk1QixRQUFTYyxHQUFJZCxTQUNKNUIsR0FBV00sUUFBUXNCLEdBak81QjVCLEVBQVdNLFVBcU9YLElBQUlxQyxJQUNGZCxRQUFTQSxFQUNUTCxRQUFTQSxFQUNUWCxPQUFRQSxFQUNSRixPQUFRQSxFQUNSSixLQUFNQSxFQUNObUIsSUFBS0EsRUFDTGMsSUFBS0EsRUFDTEUsSUFBS0EsRUFHUCxPQUFPQyxHQVFULFFBQVNDLEdBQWVDLEdBQ3RCQSxFQUFTbEMsU0FvQlgsUUFBU21DLEdBQVVDLEdBRWJaLEVBQUdDLFNBQVNXLEVBQUlwQixhQUNsQlYsRUFBT1UsVUFBWW9CLEVBQUlwQixXQUlyQlEsRUFBR0MsU0FBU1csRUFBSTdCLGFBQ2xCRCxFQUFPQyxVQUFZNkIsRUFBSTdCLFdBSXJCaUIsRUFBR0MsU0FBU1csRUFBSXRCLGNBQ2xCUixFQUFPUSxXQUFhc0IsRUFBSXRCLFlBd0I1QixRQUFTdUIsS0FDUCxNQUFPQyxHQWxVVCxHQUFJZCxHQUFLckMsRUFBT29ELFFBR1pqQyxHQUNGUSxXQUFZLHNCQUNaUCxVQUFXLHFCQUNYUyxVQUFXLGdCQTRTVHNCLEdBQ0ZILFVBQVdBLEVBRVhLLE1BQ0UsYUFBYyxRQUFTLEtBRXZCcEQsR0FjSm9DLEdBQUdpQixPQUFPLGdCQUdUQyxTQUFTLFlBQWFMLEdBR3RCTSxLQUNDLFlBRUFWLEtBR0Y5QyIsImZpbGUiOiJuZy1zZXNzaW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBuZ1Nlc3Npb25cbiAqXG4gKiBAZGVzY3JpcHRpb24gU2Vzc2lvbiBoYW5kbGVyIG1vZHVsZSBmb3IgQW5ndWxhckpTLlxuICogQG1vZHVsZSBuZ1Nlc3Npb25cbiAqIEBhdXRob3IgRmluYWwgRGV2ZWxvcG1lbnQgU3R1ZGlvXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG4oZnVuY3Rpb24gKHdpbmRvdykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIG5nID0gd2luZG93LmFuZ3VsYXI7XG5cbiAgLyogRGVmYXVsdCBjb25maWd1cmF0aW9uICovXG4gIHZhciBjb25maWcgPSB7XG4gICAgc2lnbk91dFVybDogJy9hcGkvdXNlcnMvc2lnbi1vdXQnLFxuICAgIHNpZ25JblVybDogJy9hcGkvdXNlcnMvc2lnbi1pbicsXG4gICAgdXBkYXRlVXJsOiAnL2FwaS9zZXNzaW9uJ1xuICB9O1xuXG4gIC8qKlxuICAgKiBuZ1Nlc3Npb24gc2VydmljZSBmdW5jdGlvbi5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGZ1bmN0aW9uIG5nU2Vzc2lvblNlcnZpY2VGbigkcm9vdFNjb3BlLCAkaHR0cCwgJHEpIHtcbiAgICAkcm9vdFNjb3BlLnNlc3Npb24gPSB7fTtcblxuICAgIC8qKlxuICAgICAqIEBtb2R1bGUgbmdTZXNzaW9uXG4gICAgICogQGRlc2NyaXB0aW9uIG5nU2Vzc2lvbiBTZXJ2aWNlXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBTZXNzaW9uIHVwZGF0ZSBzdWNjZXNzZnVsLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvblNlc3Npb25VcGRhdGVTdWNjZXNzKGRlZmVycmVkLCByZXMpIHtcbiAgICAgICRyb290U2NvcGUuc2Vzc2lvbi51c2VyID0gcmVzLmRhdGE7XG5cbiAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPbiBTaWduIEluIHN1Y2Nlc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9uU2luZ0luU3VjY2VzcyhkZWZlcnJlZCkge1xuICAgICAgcmV0dXJuIHVwZGF0ZShudWxsLCBkZWZlcnJlZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT24gU2lnbiBPdXQgc3VjY2Vzcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZnVuY3Rpb24gb25TaW5nT3V0U3VjY2VzcyhkZWZlcnJlZCwgcmVzKSB7XG4gICAgICAkcm9vdFNjb3BlLnNlc3Npb24udXNlciA9IG51bGw7XG5cbiAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaWducyBhIHVzZXIgaW4uXG4gICAgICpcbiAgICAgKiBJdCB3aWxsIHBlcmZvcm0gYSBgUE9TVGAgdG8gdGhlIGBjb25maWcuc2lnbk91dFVybGAgcGF0aCBhbmQgcGVyZm9ybSBhblxuICAgICAqIGB1cGRhdGVgIGlmIHN1Y2Nlc3NmdWwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSBUaGUgZGF0YSB0byBzZW5kIGZvciBzaWduIGluLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9wdGlvbmFsIEFuZ3VsYXJKUyBIVFRQIHJlcXVlc3Qgb3B0aW9ucy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIHByb21pc2UgcmVzb2x2aW5nIHRoZSByZXF1ZXN0J3MgYHJlc2Agb2JqZWN0LlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBuZ1Nlc3Npb24uc2lnbkluKCRzY29wZS5kYXRhKVxuICAgICAqICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge30pXG4gICAgICogICAuY2F0Y2goZnVuY3Rpb24gKHJlcykge30pXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2lnbkluKGRhdGEsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgIC8qIFJlbW92ZSBwcmV2aW91cyB1c2VyIG9iamVjdCAqL1xuICAgICAgJHJvb3RTY29wZS5zZXNzaW9uLnVzZXIgPSBudWxsO1xuXG4gICAgICAkaHR0cC5wb3N0KGNvbmZpZy5zaWduSW5VcmwsIGRhdGEsIG9wdGlvbnMpXG4gICAgICAgIC50aGVuKG9uU2luZ0luU3VjY2Vzcy5iaW5kKG51bGwsIGRlZmVycmVkKSlcbiAgICAgICAgLmNhdGNoKGRlZmVycmVkLnJlamVjdCk7XG5cbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNpZ25zIGEgdXNlciBvdXQuXG4gICAgICpcbiAgICAgKiBJdCB3aWxsIHBlcmZvcm0gYSBQT1NUIHRvIHRoZSBgY29uZmlnLnNpZ25PdXRVcmxgIHBhdGggYW5kIGRlbGV0ZSB0aGVcbiAgICAgKiB1c2VyIG9iamVjdCBvbiBzdWNjZXNzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgVGhlIG9wdGlvbmFsIGRhdGEgdG8gc2VuZCBmb3Igc2lnbiBvdXQuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT3B0aW9uYWwgQW5ndWxhckpTIEhUVFAgcmVxdWVzdCBvcHRpb25zLlxuICAgICAqXG4gICAgICogQHJldHVybnMge1Byb21pc2V9IEEgcHJvbWlzZSByZXNvbHZpbmcgdGhlIHJlcXVlc3QncyBgcmVzYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5nU2Vzc2lvbi5zaWduT3V0KCRzY29wZS5kYXRhKVxuICAgICAqICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge30pXG4gICAgICogICAuY2F0Y2goZnVuY3Rpb24gKHJlcykge30pXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2lnbk91dChkYXRhLCBvcHRpb25zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAkaHR0cC5wb3N0KGNvbmZpZy5zaWduT3V0VXJsLCBkYXRhLCBvcHRpb25zKVxuICAgICAgICAudGhlbihvblNpbmdPdXRTdWNjZXNzLmJpbmQobnVsbCwgZGVmZXJyZWQpKVxuICAgICAgICAuY2F0Y2goZGVmZXJyZWQucmVqZWN0KTtcblxuICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgc2Vzc2lvbiB1c2VyIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEl0IHdpbGwgcGVyZm9ybSBhIEdFVCB0byB0aGUgYGNvbmZpZy51cGRhdGVVcmxgIHBhdGggYW5kIHNldCB0aGVcbiAgICAgKiBzZXNzaW9uJ3MgdXNlciBvYmplY3Qgb24gc3VjY2VzcyB3aXRoIHRoZSByZXF1ZXN0J3MgYHJlcy5kYXRhYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9wdGlvbmFsIEFuZ3VsYXJKUyBIVFRQIHJlcXVlc3Qgb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0ge1Byb21pc2V9IGRlZmVycmVkIE9wdGlvbmFsIGRlZmVycmVkIHByb21pc2Ugb2JqZWN0LlxuICAgICAqXG4gICAgICogQHJldHVybnMge1Byb21pc2V9IEEgcHJvbWlzZSByZXNvbHZpbmcgdGhlIHJlcXVlc3QncyBgcmVzYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5nU2Vzc2lvbi51cGRhdGUoJHNjb3BlLmRhdGEpXG4gICAgICogICAudGhlbihmdW5jdGlvbiAocmVzKSB7fSlcbiAgICAgKiAgIC5jYXRjaChmdW5jdGlvbiAocmVzKSB7fSlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1cGRhdGUob3B0aW9ucywgZGVmZXJyZWQpIHtcbiAgICAgIGlmICghZGVmZXJyZWQpIHtcbiAgICAgICAgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgfVxuXG4gICAgICAvKiBSZXRyaWV2ZSBjdXJyZW50IHNlc3Npb24gKi9cbiAgICAgICRodHRwLmdldChjb25maWcudXBkYXRlVXJsLCBvcHRpb25zIHx8IHt9KVxuICAgICAgICAudGhlbihvblNlc3Npb25VcGRhdGVTdWNjZXNzLmJpbmQobnVsbCwgZGVmZXJyZWQpKVxuICAgICAgICAuY2F0Y2goZGVmZXJyZWQucmVqZWN0KTtcblxuICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGEgdXNlciBkYXRhIHZhbHVlIGJ5IHByb3BlcnR5IG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcCBUaGUgcHJvcGVydHkgbmFtZSB0byByZXRyaWV2ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtNaXhlZH0gVGhlIHByb3BlcnR5J3MgdmFsdWUgb3IgdGhlIHVzZXIgb2JqZWN0IGlmIG5vXG4gICAgICogcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlIG5nU2Vzc2lvbi51c2VyKCduYW1lJyk7IC8vID0+ICdKb2huIFNtaXRoJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVzZXIocHJvcCkge1xuICAgICAgdmFyIHNlc3Npb24gPSAkcm9vdFNjb3BlLnNlc3Npb247XG5cbiAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgaWYgKHByb3AgJiYgc2Vzc2lvbi51c2VyKSB7XG4gICAgICAgIHJldHVybiBzZXNzaW9uLnVzZXJbcHJvcF07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZXNzaW9uLnVzZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGFueSBvciBhbGwgb2YgdGhlIHByb3ZpZGVkIHJvbGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHsoU3RyaW5nfFN0cmluZ1tdKX0gcm9sZXMgVGhlIHJlcXVpcmVkIHJvbGVzLiBDYW4gYmUgYSBzaW5nbGVcbiAgICAgKiAgIHN0cmluZyBvciBhIHN0cmluZyBhcnJheS5cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGFsbCBJZiBhbGwgdGhlIHByb3ZpZGVkIHJvbGVzIGFyZSByZXF1aXJlZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5nU2Vzc2lvbi5oYXNSb2xlcygnUk9MRS5BRE1JTicpOyAvLyA9PiBmYWxzZVxuICAgICAqIG5nU2Vzc2lvbi5oYXNSb2xlcygnUk9MRS5VU0VSJyk7IC8vID0+IHRydWVcbiAgICAgKiBuZ1Nlc3Npb24uaGFzUm9sZXMoWydST0xFLkFETUlOJywgJ1JPTEUuVVNFUiddKTsgLy8gPT4gdHJ1ZVxuICAgICAqIG5nU2Vzc2lvbi5oYXNSb2xlcyhbJ1JPTEUuQURNSU4nLCAnUk9MRS5VU0VSJ10sIHRydWUpOyAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhhc1JvbGUocm9sZXMsIGFsbCkge1xuICAgICAgdmFyIGFjdHVhbCA9IHVzZXIoJ3JvbGVzJyk7XG4gICAgICB2YXIgbWF0Y2hlcyA9IDA7XG5cbiAgICAgIGlmICghYWN0dWFsIHx8ICFhY3R1YWwubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5nLmlzU3RyaW5nKGFjdHVhbCkpIHtcbiAgICAgICAgYWN0dWFsID0gW2FjdHVhbF07XG4gICAgICB9XG5cbiAgICAgIGlmIChuZy5pc1N0cmluZyhyb2xlcykpIHtcbiAgICAgICAgcm9sZXMgPSBbcm9sZXNdO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJvbGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYWN0dWFsLmluZGV4T2Yocm9sZXNbaV0pID4gLTEpIHtcbiAgICAgICAgICBtYXRjaGVzKys7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGFsbCkge1xuICAgICAgICByZXR1cm4gbWF0Y2hlcyA9PT0gcm9sZXMubGVuZ3RoO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gISFtYXRjaGVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgYSB2YWx1ZSBpbiB0aGUgc2Vzc2lvbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcCBUaGUgcHJvcGVydHkgbmFtZSB0byBzZXQuXG4gICAgICogQHBhcmFtIHtNaXhlZH0gVGhlIHByb3BlcnR5IHZhbHVlIHRvIHNldC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlIG5nU2Vzc2lvbi5zZXQoJ3Rlc3QnLCAnVGVzdCBWYWx1ZScpO1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNldChwcm9wLCB2YWx1ZSkge1xuICAgICAgJHJvb3RTY29wZS5zZXNzaW9uW3Byb3BdID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT2J0YWlucyBhIHZhbHVlIGZyb20gdGhlIHNlc3Npb24gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHByb3AgVGhlIHByb3BlcnR5IG5hbWUgdG8gb2J0YWluLlxuICAgICAqXG4gICAgICogQHJldHVybnMge01peGVkfSBUaGUgcHJvcGVydHkncyB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlIG5nU2Vzc2lvbi5nZXQoJ3Rlc3QnKTsgLy8gPT4gJ1Rlc3QgVmFsdWUnXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0KHByb3ApIHtcbiAgICAgIHJldHVybiAkcm9vdFNjb3BlLnNlc3Npb25bcHJvcF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVsZXRlcyBhIHByb3BlcnR5IGZyb20gdGhlIHNlc3Npb24gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHByb3AgVGhlIHByb3BlcnR5IG5hbWUuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5nU2Vzc2lvbi5kZWwoJ3Rlc3QnKTtcbiAgICAgKiBuZ1Nlc3Npb24uZ2V0KCd0ZXN0Jyk7IC8vID0+IG51bGxcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkZWwocHJvcCkge1xuICAgICAgZGVsZXRlICRyb290U2NvcGUuc2Vzc2lvbltwcm9wXTtcbiAgICB9XG5cbiAgICAvKiBTZXNzaW9uIHNlcnZpY2UgZGVmaW5pdGlvbiAqL1xuICAgIHZhciBuZ1Nlc3Npb25TZXJ2aWNlRGVmID0ge1xuICAgICAgaGFzUm9sZTogaGFzUm9sZSxcbiAgICAgIHNpZ25PdXQ6IHNpZ25PdXQsXG4gICAgICBzaWduSW46IHNpZ25JbixcbiAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgdXNlcjogdXNlcixcbiAgICAgIGdldDogZ2V0LFxuICAgICAgc2V0OiBzZXQsXG4gICAgICBkZWw6IGRlbFxuICAgIH07XG5cbiAgICByZXR1cm4gbmdTZXNzaW9uU2VydmljZURlZjtcbiAgfVxuXG4gIC8qKlxuICAgKiBuZ1Nlc3Npb24gcnVuIGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZnVuY3Rpb24gbmdTZXNzaW9uUnVuRm4oJHNlc3Npb24pIHtcbiAgICAkc2Vzc2lvbi51cGRhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbW9kdWxlIG5nU2Vzc2lvblByb3ZpZGVyXG4gICAqIEBkZXNjcmlwdGlvbiBuZ1Nlc3Npb24gUHJvdmlkZXJcbiAgICovXG5cbiAgLyoqXG4gICAqIENvbmZpZ3VyYXRpb24gbWV0aG9kLlxuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogbmdTZXNzaW9uUHJvdmlkZXIuY29uZmlndXJlKHtcbiAgICogICBzaWduT3V0VXJsOiAnL2FwaS91c2Vycy9zaWduLW91dCcsXG4gICAqICAgc2lnbkluVXJsOiAnL2FwaS91c2Vycy9zaWduLWluJyxcbiAgICogICB1cGRhdGVVcmw6ICcvYXBpL3Nlc3Npb24nXG4gICAqIH0pO1xuICAgKi9cbiAgZnVuY3Rpb24gY29uZmlndXJlKGNmZykge1xuICAgIC8qIFNldHMgc2Vzc2lvbiB1cGRhdGUgR0VUIFVSTCAqL1xuICAgIGlmIChuZy5pc1N0cmluZyhjZmcudXBkYXRlVXJsKSkge1xuICAgICAgY29uZmlnLnVwZGF0ZVVybCA9IGNmZy51cGRhdGVVcmw7XG4gICAgfVxuXG4gICAgLyogU2V0cyBzaWduIGluIFBPU1QgVVJMICovXG4gICAgaWYgKG5nLmlzU3RyaW5nKGNmZy5zaWduSW5VcmwpKSB7XG4gICAgICBjb25maWcuc2lnbkluVXJsID0gY2ZnLnNpZ25JblVybDtcbiAgICB9XG5cbiAgICAvKiBTZXRzIHNpZ24gb3V0IFBPU1QgVVJMICovXG4gICAgaWYgKG5nLmlzU3RyaW5nKGNmZy5zaWduT3V0VXJsKSkge1xuICAgICAgY29uZmlnLnNpZ25PdXRVcmwgPSBjZmcuc2lnbk91dFVybDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogbmdTZXNzaW9uIHByb3ZpZGVyIGRlZmluaXRpb24uXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB2YXIgbmdTZXNzaW9uUHJvdmlkZXJEZWYgPSB7XG4gICAgY29uZmlndXJlOiBjb25maWd1cmUsXG5cbiAgICAkZ2V0OiBbXG4gICAgICAnJHJvb3RTY29wZScsICckaHR0cCcsICckcScsXG5cbiAgICAgIG5nU2Vzc2lvblNlcnZpY2VGblxuICAgIF1cbiAgfTtcblxuICAvKipcbiAgICogbmdTZXNzaW9uIHByb3ZpZGVyIGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZnVuY3Rpb24gbmdTZXNzaW9uUHJvdmlkZXJGbigpIHtcbiAgICByZXR1cm4gbmdTZXNzaW9uUHJvdmlkZXJEZWY7XG4gIH1cblxuICAvKiBEZWZpbmUgQW5ndWxhckpTIG1vZHVsZSAqL1xuICBuZy5tb2R1bGUoJ25nU2Vzc2lvbicsIFtdKVxuXG4gIC8qIERlZmluZSBzZXJ2aWNlIHByb3ZpZGVyICovXG4gIC5wcm92aWRlcignbmdTZXNzaW9uJywgbmdTZXNzaW9uUHJvdmlkZXJGbilcblxuICAvKiBEZWZpbmUgQW5ndWxhckpTIG1vZHVsZSBydW4gZnVuY3Rpb24gKi9cbiAgLnJ1bihbXG4gICAgJ25nU2Vzc2lvbicsXG5cbiAgICBuZ1Nlc3Npb25SdW5GblxuICBdKTtcblxufSh3aW5kb3cpKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
